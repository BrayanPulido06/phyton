<div class="container">
  <header>
    <h1>📋 Sistema de Soporte de Personas</h1>
    <p>Registro y gestión de solicitudes de soporte</p>
    <nav class="nav-links">
      <a routerLink="/upload-excel" class="btn btn-secondary">📁 Carga Masiva Excel</a>
    </nav>
  </header>

  <main>
    <!-- Formulario de registro -->
    <section class="form-section">
      <h2>Nuevo Soporte</h2>
      <form (ngSubmit)="crearSoporte()" #soporteForm="ngForm">
        <div class="form-group">
          <label for="nombre">Nombre Completo:</label>
          <input 
            type="text" 
            id="nombre" 
            name="nombre" 
            [(ngModel)]="nuevoSoporte.nombre"
            required 
            placeholder="Ingrese el nombre completo"
          >
        </div>

        <div class="form-group">
          <label for="cedula">Cédula:</label>
          <input 
            type="text" 
            id="cedula" 
            name="cedula" 
            [(ngModel)]="nuevoSoporte.cedula"
            required 
            placeholder="Ingrese la cédula"
          >
        </div>

        <div class="form-group">
          <label for="direccion">Dirección:</label>
          <textarea 
            id="direccion" 
            name="direccion" 
            [(ngModel)]="nuevoSoporte.direccion"
            required 
            placeholder="Ingrese la dirección completa" 
            rows="3"
          ></textarea>
        </div>

        <button type="submit" class="btn btn-primary" [disabled]="!soporteForm.form.valid">
          Registrar Soporte
        </button>
      </form>
    </section>

    <!-- Mensajes de alerta -->
    <div id="alertContainer">
      <div 
        *ngFor="let alerta of alertas" 
        class="alert alert-{{ alerta.tipo }}"
      >
        {{ alerta.mensaje }}
      </div>
    </div>

    <!-- Tabla de soportes -->
    <section class="table-section">
      <h2>Lista de Soportes</h2>
      <div class="mb-3">
        <button class="btn btn-primary me-2" (click)="exportToExcel()">Exportar a Excel</button>
        <button class="btn btn-secondary" (click)="exportToPDF()">Exportar a PDF</button>
      </div>

      <table class="table table-striped">
        <thead>
          <tr>
            <th>ID</th>
            <th>Nombre</th>
            <th>Cédula</th>
            <th>Dirección</th>
            <th>Fecha de Creación</th>
          </tr>
        </thead>
        <tbody>
            <tr *ngFor="let soporte of soportes">
              <td>{{ soporte.id }}</td>
              <td>{{ soporte.nombre }}</td>
              <td>{{ soporte.cedula }}</td>
              <td>{{ soporte.direccion }}</td>
            <td>{{ soporte.fecha_creacion | date:'medium' }}</td>
          </tr>
          </tbody>
        </table>
    </section>
  </main>

  <footer>
    <p>© Soporte 2025</p>
  </footer>
</div>